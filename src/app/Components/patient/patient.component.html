<div class="container">
  <h1 class="text-success text-center my-4 text-decoration-underline">
    Add Patient
  </h1>
  <form class="row g-3 needs-validation" [formGroup]="patientFormData">
    <div class="col-md-3">
      <label for="firstname" class="form-label"
        >First name <span class="text-danger">*</span></label
      >
      <input
        type="text"
        class="form-control"
        name="firstName"
        formControlName="firstName"
      />
    </div>

    <div class="col-md-3">
      <label for="lastname" class="form-label"
        >Last name <span class="text-danger">*</span></label
      >
      <input
        type="text"
        class="form-control"
        name="lastName"
        formControlName="lastName"
      />
    </div>

    <div class="col-md-3">
      <label for="dob" class="form-label"
        >Date Of Birth <span class="text-danger">*</span></label
      >
      <input
        type="date"
        class="form-control"
        name="dob"
        [max]="currentDate"
        formControlName="dateOfBirth"
      />
    </div>

    <div class="col-md-3">
      <label for="Gender" class="form-label"
        >Gender <span class="text-danger">*</span></label
      >
      <div class="">
        <input
          type="radio"
          name="gender"
          value="male"
          formControlName="gender"
        />
        Male
        <input
          type="radio"
          name="gender"
          value="female"
          formControlName="gender"
        />
        Female
      </div>
    </div>

    <div class="col-md-3">
      <label for="phone" class="form-label"
        >Contact Number <span class="text-danger">*</span></label
      >
      <input
        type="number"
        class="form-control"
        name="phone"
        formControlName="contactNumber"
        min="8"
      />
    </div>

    <div class="col-md-3">
      <label for="validationCustomUsername" class="form-label"
        >Email <span class="text-danger">*</span></label
      >
      <div class="input-group has-validation">
        <span class="input-group-text" id="inputGroupPrepend">{{ "@" }}</span>
        <input
          type="email"
          class="form-control"
          name="userName"
          formControlName="email"
        />
      </div>
    </div>

    <div class="col-md-3">
      <label for="address1" class="form-label"
        >Address <span class="text-danger">*</span></label
      >
      <input
        type="text"
        class="form-control"
        name="address1"
        formControlName="address"
      />
    </div>

    <div class="col-md-3">
      <label for="state" class="form-label"
        >Blood Group <span class="text-danger">*</span></label
      >
      <select class="form-select" name="blood" formControlName="bloodGroup">
        <option selected disabled value="">Select Blood Group</option>
        <option value="O+">O+</option>
        <option value="O">O</option>
        <option value="A+">A+</option>
        <option value="A-">A</option>
        <option value="B+">B+</option>
        <option value="B-">B-</option>
        <option value="AB+">AB+</option>
        <option value="AB-">AB-</option>
      </select>
    </div>

    <div class="col-md-3">
      <label for="country" class="form-label"
        >Country <span class="text-danger">*</span></label
      >
      <select
        class="form-select"
        name="country"
        formControlName="countryId"
        (change)="onChangeCountry()"
      >
        <option selected disabled value="">Select-Country</option>
        <option
          *ngFor="let c of countriesList; trackBy: trackByContries"
          [value]="c.countryId"
        >
          {{ c.countryName }}
        </option>
      </select>
    </div>

    <div class="col-md-3">
      <label for="state" class="form-label"
        >State<span class="text-danger">*</span></label
      >
      <select
        class="form-select"
        name="state"
        formControlName="stateId"
        (change)="onChangeState()"
      >
        <option selected disabled value="">Select-State</option>
        <option
          *ngFor="let s of stateList; trackBy: trackByState"
          [value]="s.stateId"
        >
          {{ s.stateName }}
        </option>
      </select>
    </div>

    <div class="col-md-3">
      <label for="city" class="form-label"
        >City <span class="text-danger">*</span></label
      >
      <!-- <input type="text" class="form-control" name="city" /> -->
      <select class="form-select" name="city" formControlName="cityId">
        <option selected disabled value="">Select-City</option>
        <option
          *ngFor="let c of cityList; trackBy: trackByCity"
          [value]="c.cityId"
        >
          {{ c.cityName }}
        </option>
      </select>
    </div>

    <div class="col-12">
      <input
        class="form-check-input border-black border-1"
        type="checkbox"
        name="isChecked"
        id="rememberMe"
        formControlName="isChecked"
      />
      &nbsp;
      <label for="rememberMe">
        Accept Tearms and Conditions <span class="text-danger">*</span></label
      >
    </div>
    <div class="col-12 row mt-3">
      <div class="col-2">
        @if (!isUpdate) {
        <button
          class="btn btn-primary"
          type="submit"
          [disabled]="patientFormData.invalid"
          (click)="onClickSave()"
        >
          Submit form
        </button>
        }@else {
        <button
          type="button"
          class="btn btn-success"
          (click)="onClickUpdate()"
          [disabled]="patientFormData.invalid"
        >
          Update
        </button>
        }
      </div>
      <div class="col-3">
        <button
          type="button"
          class="btn btn-danger"
          (click)="resetPatientForm()"
        >
          Clear Form
        </button>
      </div>
    </div>
  </form>

  <!-- Table start here -->
  <div class="mt-4">
    <table class="table mt-3 table-bordered">
      <thead>
        <tr>
          <th>UserId</th>
          <th>FirstName</th>
          <th>Email</th>
          <th>dateOfBirth</th>
          <th>country</th>
          <th>state</th>
          <th>city</th>
          <th>Edit</th>
          <th>Delete</th>
        </tr>
      </thead>
      <tbody>
        @for (p of allPatients; track $index) {
        <tr>
          <td>{{ p.patientId }}</td>
          <td>{{ p.firstName }}</td>
          <td>{{ p.email }}</td>
          <td>{{ p.dateOfBirth | date : "yyyy-MM-dd" }}</td>
          <td>{{ p.countryName }}</td>
          <td>{{ p.stateName }}</td>
          <td>{{ p.cityName }}</td>
          <td>
            <button class="btn btn-warning" (click)="onClickEdit(p.patientId)">
              Edit
            </button>
          </td>
          <td>
            <button class="btn btn-danger" (click)="onClickDelete(p.patientId)">
              Delete
            </button>
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>

  <div>
    <div class="d-flex gap-5 justify-content-evenly mb-5 mt-3">
      <button
        class="btn btn-success"
        [disabled]="pageNumber == 1"
        (click)="onClickPrev()"
      >
        Prev
      </button>
      <div>
        <strong>{{ pageNumber }}</strong>
      </div>
      <button class="btn btn-success" (click)="onClickNext()">Next</button>
    </div>
  </div>
</div>
